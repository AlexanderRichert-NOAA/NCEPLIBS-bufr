<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-bufr: writsa.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NCEPLIBS-bufr
   &#160;<span id="projectnumber">11.3.1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('writsa_8f.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">writsa.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="writsa_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a50e3c630fd99f545e2427fe9b18c4d48"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="writsa_8f.html#a50e3c630fd99f545e2427fe9b18c4d48">writsa</a> (LUNXX, LMSGT, MSGT, MSGL)</td></tr>
<tr class="memdesc:a50e3c630fd99f545e2427fe9b18c4d48"><td class="mdescLeft">&#160;</td><td class="mdescRight">THIS SUBROUTINE SHOULD ONLY BE CALLED WHEN LOGICAL UNIT ABS(LUNXX) HAS BEEN OPENED FOR OUTPUT OPERATIONS.  <a href="writsa_8f.html#a50e3c630fd99f545e2427fe9b18c4d48">More...</a><br /></td></tr>
<tr class="separator:a50e3c630fd99f545e2427fe9b18c4d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>WOOLLEN </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1994-01-06 </dd></dl>

<p class="definition">Definition in file <a class="el" href="writsa_8f_source.html">writsa.f</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a50e3c630fd99f545e2427fe9b18c4d48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50e3c630fd99f545e2427fe9b18c4d48">&#9670;&nbsp;</a></span>writsa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine writsa </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>LUNXX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>LMSGT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dimension(*)&#160;</td>
          <td class="paramname"><em>MSGT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>MSGL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>THIS SUBROUTINE SHOULD ONLY BE CALLED WHEN LOGICAL UNIT ABS(LUNXX) HAS BEEN OPENED FOR OUTPUT OPERATIONS. </p>
<p>WHEN LUNXX IS GREATER THAN ZERO, IT PACKS UP THE CURRENT SUBSET WITHIN MEMORY AND THEN TRIES TO ADD IT TO THE BUFR MESSAGE THAT IS CURRENTLY OPEN WITHIN MEMORY FOR ABS(LUNXX). THE DETERMINATION AS TO WHETHER OR NOT THE SUBSET CAN BE ADDED TO THE MESSAGE IS MADE VIA AN INTERNAL CALL TO ONE OF THE BUFR ARCHIVE LIBRARY SUBROUTINES WRCMPS OR MSGUPD, DEPENDING UPON WHETHER OR NOT THE MESSAGE IS COMPRESSED. IF IT TURNS OUT THAT THE SUBSET CANNOT BE ADDED TO THE CURRENTLY OPEN MESSAGE, THEN THAT MESSAGE IS FLUSHED TO ABS(LUNXX) AND A NEW ONE IS CREATED IN ORDER TO HOLD THE SUBSET. AS LONG AS LUNXX IS GREATER THAN ZERO, WRITSA FUNCTIONS EXACTLY LIKE BUFR ARCHIVE LIBRARY SUBROUTINE WRITSB, EXCEPT THAT WRITSA ALSO RETURNS A COPY OF EACH COMPLETED BUFR MESSAGE TO THE APPLICATION PROGRAM IN THE FIRST MSGL WORDS OF ARRAY MSGT.</p>
<p>ALTERNATIVELY, WHEN LUNXX IS LESS THAN ZERO, THIS IS A SIGNAL TO FORCE ANY CURRENT MESSAGE IN MEMORY TO BE FLUSHED TO ABS(LUNXX) AND RETURNED IN ARRAY MSGT. IN SUCH CASES, ANY CURRENT SUBSET IN MEMORY IS IGNORED. THIS OPTION IS NECESSARY BECAUSE ANY MESSAGE RETURNED IN MSGT FROM A CALL TO THIS ROUTINE NEVER CONTAINS THE ACTUAL SUBSET THAT WAS PACKED UP AND STORED DURING THE SAME CALL TO THIS ROUTINE. THEREFORE, THE ONLY WAY TO ENSURE THAT EVERY LAST BUFR SUBSET IS RETURNED WITHIN A BUFR MESSAGE IN MSGT BEFORE, E.G., EXITING THE APPLICATION PROGRAM, IS TO DO ONE FINAL CALL TO THIS ROUTINE WITH LUNXX LESS THAN ZERO IN ORDER TO FORCIBLY FLUSH OUT AND RETURN ONE FINAL BUFR MESSAGE.</p>
<p>PROGRAM HISTORY LOG: 1994-01-06 J. WOOLLEN &ndash; ORIGINAL AUTHOR 1998-07-08 J. WOOLLEN &ndash; REPLACED CALL TO CRAY LIBRARY ROUTINE "ABORT" WITH CALL TO NEW INTERNAL BUFRLIB ROUTINE "BORT" 2000-09-19 J. WOOLLEN &ndash; MAXIMUM MESSAGE LENGTH INCREASED FROM 10,000 TO 20,000 BYTES 2003-11-04 S. BENDER &ndash; ADDED REMARKS/BUFRLIB ROUTINE INTERDEPENDENCIES 2003-11-04 D. KEYSER &ndash; UNIFIED/PORTABLE FOR WRF; ADDED DOCUMENTATION (INCLUDING HISTORY); OUTPUTS MORE COMPLETE DIAGNOSTIC INFO WHEN ROUTINE TERMINATES ABNORMALLY 2004-08-18 J. ATOR &ndash; ADD POST-MSGUPD CHECK FOR AND RETURN OF MESSAGE WITHIN MSGT IN ORDER TO PREVENT LOSS OF MESSAGE IN CERTAIN SITUATIONS; MAXIMUM MESSAGE LENGTH INCREASED FROM 20,000 TO 50,000 BYTES 2005-03-09 J. ATOR &ndash; ADDED CAPABILITY FOR COMPRESSED MESSAGES 2009-03-23 J. ATOR &ndash; ADDED LMSGT ARGUMENT AND CHECK 2014-12-10 J. ATOR &ndash; USE MODULES INSTEAD OF COMMON BLOCKS 2019-05-09 J. ATOR &ndash; ADDED DIMENSIONS FOR MSGLEN AND MSGTXT</p>
<p>USAGE: CALL WRITSA (LUNXX, LMSGT, MSGT, MSGL) INPUT ARGUMENT LIST: LUNXX - INTEGER: ABSOLUTE VALUE IS FORTRAN LOGICAL UNIT NUMBER FOR BUFR FILE {IF LUNXX IS LESS THAN ZERO, THEN ANY CURRENT MESSAGE IN MEMORY WILL BE FORCIBLY FLUSHED TO ABS(LUNXX) AND TO ARRAY MSGT} LMSGT - INTEGER: DIMENSIONED SIZE (IN INTEGER WORDS) OF MSGT; USED BY THE SUBROUTINE TO ENSURE THAT IT DOES NOT OVERFLOW THE MSGT ARRAY</p>
<p>OUTPUT ARGUMENT LIST: MSGT - INTEGER: *-WORD PACKED BINARY ARRAY CONTAINING BUFR MESSAGE (FIRST MSGL WORDS FILLED) MSGL - INTEGER: NUMBER OF WORDS FILLED IN MSGT 0 = no message was returned</p>
<p>REMARKS: THIS ROUTINE CALLS: BORT CLOSMG MSGUPD STATUS WRCMPS WRTREE THIS ROUTINE IS CALLED BY: None Normally called only by application programs. </p>

<p class="definition">Definition at line <a class="el" href="writsa_8f_source.html#l00080">80</a> of file <a class="el" href="writsa_8f_source.html">writsa.f</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="writsa_8f.html">writsa.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
